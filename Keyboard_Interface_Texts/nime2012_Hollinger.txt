Optoelectronic Acquisition and Control Board for Musical
Applications
Avrum Hollinger
Input Devices and Music Interaction Lab,
Centre for Interdisciplinary Research in Music
Media and Technology,
McGill University
avrum@music.mcgill.ca
Marcelo M. Wanderley
Input Devices and Music Interaction Lab,
Centre for Interdisciplinary Research in Music
Media and Technology,
McGill University
marcelo.wanderley@mcgill.ca
ABSTRACT
A modular and reconﬁgurable hardware platform for analog
optoelectronic signal acquisition is presented. Its intended
application is for ﬁber optic sensing in electronic musical
interfaces, however the ﬂexible design enables its use with
a wide range of analog and digital sensors. Multiple gain
and multiplexing stages as well as programmable analog and
digital hardware blocks allow for the acquisition, processing,
and communication of single-ended and diﬀerential signals.
Along with a hub board, multiple acquisition boards can
be connected to modularly extend the system’s capabilities
to suit the needs of the application. Fiber optic sensors
and their application in DMIs are brieﬂy discussed, as well
as the use of the hardware platform with speciﬁc musical
interfaces.
Keywords
ﬁber optic sensing, analog signal acquisition, musical inter-
face, MRI-compatible
1. INTRODUCTION
The ability to acquire sensor data is paramount to direct
measurement of musician gestures in digital musical instru-
ments (DMI). While more and more sensor packages have
digital outputs, there are many DMI applications where
analog acquisition and signal processing is still required
[19]. Sensing techniques vary depending on the nature of
the environment and the phenomena being sensed. Optical
sensing is advantageous in situations where electromagnetic
interference (EMI) is of concern. Of speciﬁc challenge to the
authors is the design of digital musical interfaces compatible
with magnetic resonance imaging (MRI). Using functional
MRI, neuroscientists are able to correlate musician gestures
with neural activation to better understand the brain struc-
tures and pathways involved in musical motor learning [1,
8, 17, 2]. The MRI scanner uses high-intensity magnetic
and radio-frequency ﬁelds which interfere with most elec-
tronics [7]. As well, electronics brought into the MRI room
can interfere with the sensitive MRI acquisition hardware,
distorting images or posing a potential threat to the safety
of subjects and technicians. Development time in the MRI
scanner is expensive thus an all-optical approach to sens-
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
NIME’12,May 21 – 23, 2012, University of Michigan, Ann Arbor.
Copyright remains with the author(s).
ing decreases costs and ensures MRI-compatibility, even in
newer high-ﬁeld scanners.
This paper details the design of an analog acquisition
and control board designed speciﬁcally for optical sensing in
DMIs. While optical sensing was the focus for this hardware
platform, it is easily reconﬁgurable and reprogrammable to
tackle most analog and mixed-signal needs. This platform
can operate on its own or integrated as a node device into
the hub-and-node framework presented in [9]. As well, this
work is a complete redesign of the hardware presented in [8].
Whereas the previous revision consumed signiﬁcant setup
time with hand-tuned comparators reference signals, this
platform uses analog-to-digital conversion (ADC) and can
be auto-calibrated.
2. FIBER OPTIC SENSING TECHNIQUES
While optical sensing has been applied to DMIs [14, 11,
16], few interfaces have made use of the the possibilities
that ﬁber optic sensors provide [6, 10, 8, 12]. Optical ﬁbers
make use of total-internal reﬂection of light in order to
maintain signal strength over long cable runs without be-
ing susceptible to EMI. An example application of the use
of ﬁber optic cables in musical instruments is the design
of electromagnetically-actuated pipe organs where control
signals need to travel long distances from the control panel
to the pipes without being corrupted by EMI generated by
electromechanical valves [5]. Outside of the musical realm,
ﬁber optic sensing is commonly used for remote tempera-
ture measurement in dangerous locations, stress and strain
within bridges and roads, and for in vivo medical imaging
[15, 18].
The simplest types of sensors modulate light intensity,
while more complex arrangements can be used to measure
polarization, interferometric phase shifts, and wavelength
modulation [20]. Example applications of simple intensity-
based ﬁber optic sensing for for DMIs include the use of
bend sensors to measure ﬂexion and force, end-coupled re-
ﬂective diaphragm for vibration sensing, and optical quadra-
ture (or other photo-mask conﬁgurations) for position and
velocity measurements, among many others [7].
3. ACQUISITION AND CONTROL BOARD
The purpose of the optoelectronic acquisition board is to
interrogate ﬁber optic sensors, perform basic signal process-
ing, digitize acquired signals, and communicate data to the
hub. The hardware platform is comprised of several sub-
sections including: power supply, analog front end, light-
emitting diode (LED) drivers, the programmable system-
on-chip (PSoC), and a USB-to-UART integrated circuit for
communication. The board is based around a Cypress PSoC
which consists of an 8-bit microcontroller with integrated
Table 1: Optoelectronic control board features.
Feature Description
µC 8-bit microprocessor core, up to 24MHz
clock, with analog and digital blocks
Ampliﬁers 8 oﬀ-chip opamps, 8 variable-gain instru-
mentation ampliﬁers, and up to 4 on-chip
PGAs
Analog
µC inputs
Externally-multiplexed onto 8 analog pins,
internally multiplexed onto 4 analog buses
ADC Many choices available, e.g. three simulta-
neous 8-bit conversions at 3kHz
Analog
outputs
4 buﬀered outputs, available input from
analog inputs or DAC
LEDs Eight buﬀered digital outputs, PWM drive
Power
supplies
5V USB and 3.3V (digital), 3.3V and 1.8V
(analog)
Comm. USB, I2C, SPI, and others
Optical
sensing
Photodiodes and high-intensity LEDs cou-
pled to POF ST connectors for remote op-
tical sensing
Modularity I2C for board-to-board communication on
a hub and node bus
Reconﬁ-
gurable
Run-time control of analog multiplexing
and gain, on-chip analog and digital blocks
conﬁgured through ﬁrmware
reconﬁgurable analog and digital blocks [3]. See Table 1 for
a summary of the board’s features.
3.1 Analog Front End and LED Drivers
The analog subsection is comprised of eight opamps and
eight instrumentation ampliﬁers. The gains of the latter
are electronically-programmable. The outputs from these
16 ampliﬁers are multiplexed down to eight channels which
connect to analog input pins of the PSoC. For optoelec-
tronic acquisition, straight tip (ST) ﬁber optic housings are
employed to allow for quick and robust connection to ST-
terminated plastic optical ﬁber (POF) cables. Eight ST
housings with photodiodes are connected to the opamps
wired as transimpedance ampliﬁers. Photodiodes provide
a high bandwidth linear current proportional to light inten-
sity. Six diﬀerent pair-wise conﬁgurations are connected to
instrumentation ampliﬁers. This allows for the multiplexing
of eight single-ended and six diﬀerential measurements. The
instrumentation ampliﬁer gains are set by electronic poten-
tiometers, controlled by the PSoC over a serial peripheral
interface (SPI) bus.
Eight red (660 nm) LEDs in ST housing were selected to
match the transmission spectrum of the POF [13]. MOS-
FET switches are used to drive the LEDs, controlled by
the PSoC. The eﬀective LED intensity can be controlled by
modulating the duty cycle of a pulse-width-modulated sig-
nal of a suﬃciently high frequency. At the far end of the
emitting and receiving ﬁbers, optical measurements can be
made. Four emitter followers are wired to buﬀer analog out-
puts from the PSoC to drive LEDs or actuators. Four addi-
tional PSoC pins with special connection to speciﬁc analog
blocks are also brought out to a header on the board.
It should be noted that the board was fabricated with
space to install additional passive components on the ana-
log front end in order to accommodate resistive or voltage-
based sensors, as well as active ﬁltering. Two of the instru-
mentation ampliﬁers are left uncommitted and can be used
for strain gauges or bio-signal electrodes (e.g. electromyo-
gram, electroencephalogram, galvanic skin response). Fig.
1 shows a sample conﬁguration with three PWM-controlled
LEDs coupled with ﬁber optic cable to four photodiodes,
providing four single-ended measurements and three diﬀer-
ential measurements.
3.2 Internal PSoC Hardware and Firmware
Internally, the PSoC has several reconﬁgurable analog and
digital hardware blocks in addition to the 8-bit micropro-
cessor core, all programmable through ﬁrmware. Thus, de-
pending on the application, the board can be reconﬁgured
to suit the developer’s needs: one conﬁguration might re-
quire one diﬀerential analog input to be bandpass-ﬁltered
and digitized with a 14-bit ADC at 10kHz in order to drive a
single degree-of-freedom haptic interface using a digital-to-
analog converter (DAC), while another conﬁguration might
require the programmable ampliﬁcation and digitization of
several slowly-varying analog signals that are then sent oﬀ-
board for logging or further processing for an interactive
multimedia installation. The system allows for both of these
hardware conﬁgurations to exist simultaneously or toggled
at run-time.
For the acquisition of single-ended and diﬀerential opto-
electronic signals, a single internal hardware conﬁguration
was implemented with a programmable analog gain and
multiplexing structure to allow for a ﬂexible trade-oﬀ be-
tween the number of acquired signals and the acquisition
speed. The higher-level settings including the selection and
ordering of channel acquisition, data reporting selection and
speed, LED intensity, internal and external gain stage set-
tings, and calibration can be modiﬁed at run-time through
commands sent to either the USB port or over I2C. Aux-
iliary PSoC pins are brought out to headers and reserved
for additional digital communication (e.g. secondary SPI
master and slave busses) and in-circuit serial programming.
3.2.1 PSoC Hardware Conﬁguration
The application-speciﬁc internal hardware conﬁguration en-
ables the multiplexing of the eight analog inputs onto three
programmable-gain ampliﬁers (PGA) before being synch-
ronously digitized with a three-channel 8-bit ADC running
at 3kHz. Six of the eight LEDs are PWM-controlled, allow-
ing for variable intensity output. An SPI master block is
used to control the electronic potentiometers which set the
instrumentation ampliﬁer gains. An I2C slave block is im-
plemented to send acquisition data and receive commands
from a hub board with an ARM-core microcontroller, while
a UART block is connected to the external UART-to-USB
chip to allow for an auxiliary communications channel. Non-
volatile memory (NVM) is used to store and load settings
and calibration data. Additionally, a 16-bit counter block
is used to control the timing of certain interrupt service
routines (ISR).
3.2.2 Application Firmware
On boot-up, the system and all its hardware blocks and
registers are initialized. If valid, settings from a prior con-
ﬁguration are loaded from NVM. The ADC acquisition ISR
steps through the selected subset of possible input chan-
nels (referred to as an acquisition frame), setting respective
multiplexer switches and gain settings before each three-
channel parallel acquisition is initiated. Upon acquisition
of an entire frame, the data is loaded into the I2C buﬀer to
be read by the I2C master device. If enabled, data can be
printed without polling to the USB port at a rate and in an
order selectable at run-time. Otherwise data can be polled
over I2C or USB.
An auto-calibration procedure is implemented which ﬁrst
maximizes the LED outputs so as not to saturate the pho-
todiodes, then the dynamic range of the diﬀerential chan-
A
g
Switches
MUX
*
SPI-Controlled 
Potentiometers
MUX
PGA ADC
PSoC
I2C to Hub
UART to USBPWM
Ø
Amplifiers
Instrumentation
Amplifiers
Transimpedance
Photodiodes
Fibers
Optical
LEDs
*
*
*
A
A
A
g
g
Ø
Ø
Ø
I2C
UART
SPI
PWM-Controlled 
LEDs
Figure 1: Analog front end, showing an example conﬁguration utilizing four optical channels: three diﬀer-
ential and four single-ended.
nels is maximized by setting the instrumentation ampliﬁer
gains, and ﬁnally the dynamic range of the input to the
ADC is maximized by setting the PGA gains. In order to
properly calibrate the analog signal chain, a run-time com-
mand is available to pair speciﬁc LEDs with their respective
photodiode channels. Ambient light compensation is imple-
mented by taking the diﬀerence between a signal captured
with its respective LED on, versus with the LED oﬀ. As
noted, calibration values and other settings including I2C
address and LED-photodiode pairings can be saved to, and
loaded from, NVM using commands sent over USB or I2C.
4. HUB BOARD
The purpose of the hub board is to collate acquired signals
from multiple optoelectronic boards, centrally conﬁgure the
nodes, provide higher-level signal processing, time-stamp
incoming data from multiple sources, and act as a commu-
nication link between the interface and the host computer
if required by the application. While the node boards are
able to communicate directly with the host computer, this
channel is reserved for manual conﬁguration and debugging.
The hub board is based on a 32-bit ARM Cortex M3 micro-
controller. The I2C bus is used as the main communications
link between it and the node boards, however SPI is sug-
gested for higher-speed data transfer. The hub board is also
used to run mapping and synthesis algorithms as discussed
in [9]. Fig. 2 shows a prototype optoelectronic board with
four eﬀerent ﬁbers and eight aﬀerent ﬁbers connected in a
diﬀerential conﬁguration, along with an I2C connection to
a hub board and a USB connection to a laptop computer.
5. APPLICATION IN DMIs
The optoelectronic acquisition and control board has been
used with three diﬀerent interfaces for musical expression:
the MRI-compatible piano keyboard presented in [8]; a sec-
ond revision of the MRI-compatible keyboard, which makes
use of diﬀerential photo-masks to more accurately measure
key position and velocity; and the Ballagumi, a ﬂexible sili-
cone interface embedded with ﬁber optic bend and pressure
sensors, shown in Fig. 3 and presented in [12]. For the
Ballagumi, the optoelectronic boards are used to acquire
bend and deformation signals from 32 optical ﬁbers, which
Figure 2: Optoelectronic acquisition and control
board with ﬁber optic connectors.
are then analyzed and mapped on the hub board or a PC
to sound synthesis. The modular and reconﬁgurable opto-
electronic boards, in consort with a hub board, enable a
single hardware platform to be used with diﬀerent physical
interfaces and optical sensing techniques with little to no
change in hardware or ﬁrmware, using run-time commands
to reconﬁgure the platform to suit the needs of the speciﬁc
application. To replace the photodiodes with resistive or
voltage-based sensors, they simply need to be connected to
the opamp inputs directly, rather than the transimpedance
architecture inputs. In addition to LEDs for visual feed-
back, small actuators can be connected to the buﬀered ana-
log outputs for haptic feedback, driven with an arbitrary
control signal using the DAC or directly with an ampliﬁed
input signal.
6. CURRENT AND FUTURE WORK
A second generation optoelectronic acquisition and control
board has been designed. Fabrication is in progress and
thereafter application development and testing will com-
Figure 3: The Ballagumi: an optically-sensed ﬂexi-
ble musical instrument.
mence. The main goals of the updated design are to de-
crease the form factor, improve the analog signal integrity,
and increase the acquisition rate and data throughput. The
board is based on the recently-released PSoC 5 which fea-
tures a 32-bit ARM Cortex M3 core running at 80MHz
with integrated USB device support, analog and digital
blocks, and in-system debugging capabilities [4]. In ad-
dition to the PSoC 5, the newly designed board features
adjustable high-capacity constant-current LED drivers to
allow for more precise setting of LED light intensity; a
micro-SD card slot for additional non-volatile storage; an
electronically-controlled adjustable voltage reference; a more
numerous array and ﬂexible mapping of analog and digital
pins; as well as uncommitted electronically-controlled po-
tentiometers for interfacing with analog sensors and active
ﬁlters.
7. ACKNOWLEDGMENTS
Many thanks to the Natural Sciences and Engineering Re-
search Council of Canada (NSERC) Discovery Grant and
Canadian Foundation for Innovation (CFI) for funding this
research. Thanks as well to Sunstone Circuits for their aca-
demic sponsorship discount.
8. REFERENCES
[1] M. Bangert, T. Peschel, G. Schlaug, M. Rotte,
D. Drescher, H. Hinrichs, H.-J. Heinze, and
E. Altenmuller. Shared networks for auditory and
motor processing in professional pianists: Evidence
from fMRI conjunction. NeuroImage, 30:917–926,
Apr. 2006.
[2] R. Brown, J. Chen, A. Hollinger, V. Penhune,
C. Palmer, and R. Zatorre. Behavioral and neural
basis for auditory-motor interactions in music
performance. In Annual Meeting of the Cognitive
Neuroscience Society, April 2010.
[3] Cypress Semiconductor. CY8C29466, CY8C29566,
CY8C29666, and CY8C29866 PSoC programmable
system-on-chip data sheet. Technical report, Cypress
Semiconductor Corp., 2011.
[4] Cypress Semiconductor. PSoC5: CY8C55 family data
sheet. http://www.cypress.com/?rID=37581, Mar.
2012.
[5] A. Czyzewski and G. Papanikolaou. Computer control
of the pipe organ. In Audio Engineering Society
Convention 88, March 1990.
[6] L. Danisch. Fiber optic bending and positioning
sensor with selected curved light emission surfaces.
Patent application, September 1995. United States
Patent 5633494.
[7] A. Hollinger. Design of fMRI-compatible electronic
musical interfaces. Master’s thesis, McGill University,
2008.
[8] A. Hollinger, C. Steele, V. Penhune, R. Zatorre, and
M. Wanderley. fMRI-compatible electronic controllers.
In Proceedings of the 7th international conference on
New interfaces for musical expression, 2007.
[9] A. Hollinger, J. Thibodeau, and M. M. Wanderley. An
embedded hardware platform for fungible interfaces.
In Proceedings of the International Computer Music
Conference, pages 26–29. ICMA, May 2010.
[10] R. D. Inkster. Touch pad using a non-electrical
deformable pressure sensor. Patent application,
November 2001. United States Patent 6788295.
[11] I. Magun, F. Guerrero, and E. J. Jimenez. Gestural
control using a laser harp. In 16th International
Conference on Electronics, Communications and
Computers, 2006. CONIELECOMP 2006, pages 36–
36. IEEE, Feb. 2006.
[12] J. Malloch, S. Sinclair, A. Hollinger, and
M. Wanderley. Input devices and music interaction. In
J. Solis and K. Ng, editors, Musical Robots and
Interactive Multimodal Systems, volume 74 of
Springer Tracts in Advanced Robotics, pages 67–83.
Springer Berlin / Heidelberg, 2011.
[13] Mitsubishi Rayon Co., Ltd. Speciﬁcatino sheet: SH
4001 super eska polyethylene jacketed optical ﬁber
cord. Technical report, Industrial Fiber Optics Inc.,
2001. Available:
http://www.i-fiberoptics.com/pdf/SH4001.pdf.
[14] J. Paradiso. Electronic music: new ways to play.
IEEE Spectrum, 34:18–30, 1997.
[15] E. Pinet, C. Hamel, B. Glisic, D. Inaudi, and
N. Miron. Health monitoring with optical ﬁber
sensors: from human body to civil structures. In
T. Kundu, editor, Health Monitoring of Structural
and Biological Systems 2007, volume 6532, pages
653219–12, San Diego, California, USA, Apr. 2007.
SPIE.
[16] M. Rohs and G. Essl. CaMus 2: optical ﬂow and
collaboration in camera phone music performance. In
Proceedings of the 7th international conference on
New interfaces for musical expression, NIME ’07,
pages 160–163, New York, NY, USA, 2007. ACM.
[17] C. J. Steele and V. B. Penhune. Speciﬁc increases
within global decreases: A functional magnetic
resonance imaging investigation of ﬁve days of motor
sequence learning. The Journal of Neuroscience,
30(24):8332 –8341, June 2010.
[18] G. J. Tearney, M. E. Brezinski, B. E. Bouma, S. A.
Boppart, C. Pitris, J. F. Southern, and J. G.
Fujimoto. In vivo endoscopic optical biopsy with
optical coherence tomography. Science,
276(5321):2037–2039, June 1997.
[19] T. Todoroﬀ. Wireless digital/analog sensors for music
and dance performances. In Proceedings of the
International Conference on New Interfaces for
Musical Expression, pages 515–518, Oslo, Norway,
2011.
[20] E. Udd. Fiber optic sensors : an introduction for
engineers and scientists. Wiley, New York, 1991.